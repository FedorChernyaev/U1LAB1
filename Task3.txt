select count(*),
CUSTOMER_AGE
from SA_CUSTOMERS.SA_CUSTOMERS
GROUP BY CUSTOMER_AGE;

select count(*),
CUSTOMER_FIRST_NAME
from SA_CUSTOMERS.SA_CUSTOMERS
GROUP BY CUSTOMER_FIRST_NAME;

select count(*),
CUSTOMER_FIRST_NAME
from SA_CUSTOMERS.SA_CUSTOMERS
GROUP BY CUSTOMER_FIRST_NAME;

select count(*),
CUSTOMER_DESC
from SA_CUSTOMERS.SA_CUSTOMERS
GROUP BY CUSTOMER_DESC;

DROP TABLE SA_CUSTOMERS.SA_CUSTOMERS_TEST;

create table SA_CUSTOMERS.SA_CUSTOMERS_TEST (
CUSTOMER_ID NUMBER,
CUSTOMER_DESC CHAR(50),
CUSTOMER_FIRST_NAME CHAR(20),
CUSTOMER_LAST_NAME CHAR(20),
CUSTOMER_AGE NUMBER,
CUSTOMER_GENDER CHAR(20),
QUANTITY NUMBER);

 INSERT INTO SA_CUSTOMERS.SA_CUSTOMERS_TEST
  SELECT ROWNUM,
  randomdescr,
  'udentified',
 'udentified',
  round(DBMS_RANDOM.VALUE(18,100),0),
  'male',
  0
  FROM dual
  CONNECT BY LEVEL <= 100000;      
  
  
SELECT * FROM SA_CUSTOMERS.SA_CUSTOMERS_TEST;

MERGE INTO SA_CUSTOMERS.SA_CUSTOMERS_TEST TST
USING (SELECT CUSTOMER_ID,CUSTOMER_FIRST_NAME,CUSTOMER_LAST_NAME FROM SA_CUSTOMERS.SA_CUSTOMERS) ORIG
ON (TST.CUSTOMER_ID=ORIG.CUSTOMER_ID)
WHEN MATCHED
THEN UPDATE SET CUSTOMER_FIRST_NAME=ORIG.CUSTOMER_FIRST_NAME,CUSTOMER_LAST_NAME=ORIG.CUSTOMER_LAST_NAME
WHEN NOT MATCHED THEN INSERT (CUSTOMER_FIRST_NAME,CUSTOMER_LAST_NAME)
VALUES ('NO INFO','NO INFO');

SELECT * FROM SA_CUSTOMERS.SA_CUSTOMERS_TEST;

MERGE INTO SA_CUSTOMERS.SA_CUSTOMERS_TEST TST
USING (SELECT COUNT(*) tmp_count,CUSTOMER_FIRST_NAME,CUSTOMER_LAST_NAME FROM SA_CUSTOMERS.SA_CUSTOMERS GROUP BY CUSTOMER_FIRST_NAME, CUSTOMER_LAST_NAME ) ORIG
ON (TST.CUSTOMER_FIRST_NAME = ORIG.CUSTOMER_FIRST_NAME AND TST.CUSTOMER_LAST_NAME = ORIG.CUSTOMER_LAST_NAME)
WHEN MATCHED
THEN UPDATE SET QUANTITY = tmp_count;


SELECT * FROM SA_CUSTOMERS.SA_CUSTOMERS_TEST;












